title: function
date: 2017-03-26 13:45:31
tags:
banner:
---
函数可以让我们将一个语句序列打包为一个单元，然后可以从程序中其它地方多次调用, 对于任何编程语言来说，函数都是一个至关重要的部分。
<!-- more -->

* 函数声明包括函数名、形式参数列表、返回值列表（可省略）以及函数体
* 参数作为局部变量
* 返回值也可以像形式参数一样被命名。在这种情况下，每个返回值被声明成一个局部变量，并根据该返回值的类型，将其初始化为0
* 函数的类型被称为函数的标识符。如果两个函数形式参数列表和返回值列表中的变量类型一一对应，那么这两个函数被认为有相同的类型和标识符
* 每一次函数调用都必须按照声明顺序为所有参数提供实参（参数值）。在函数调用时，Go语言没有默认参数值，也没有任何方法可以通过参数名指定形参，因此形参和返回值的变量名对于函数调用者而言没有意义。
* 你可能会偶尔遇到没有函数体的函数声明，这表示该函数不是以Go实现的。这样的声明定义了函数标识符

```go
package math
func Sin(x float64) float //implemented in assembly language
```

* Go语言使用可变栈，栈的大小按需增加(初始时很小)。这使得我们使用递归时不必考虑溢出和安全问题
* 如果一个函数将所有的返回值都显示的变量名，那么该函数的return语句可以省略操作数。这称之为bare return。
* Go使用控制流机制（如if和return）处理异常，这使得编码人员能更多的关注错误处理


### 错误处理策略

* 传播错误
* 重新尝试失败的操作 (如果错误的发生是偶然性的，或由不可预知的问题导致的)
* 错误发生后，程序无法继续运行，我们就可以采用第三种策略：输出错误信息并结束程序(这种策略只应在main中执行, 对库函数而言，应仅向上传播错误，除非该错误意味着程序内部包含不一致性，即遇到了bug，才能在库函数中结束程序)
* 有时，我们只需要输出错误信息就足够了，不需要中断程序的运行。我们可以通过log包提供函数
* 可以直接忽略掉错误

在Go中，错误处理有一套独特的编码风格。检查某个子函数是否失败后，我们通常将处理失败的逻辑代码放在处理成功的代码之前。如果某个错误会导致函数返回，那么成功时的逻辑代码不应放在else语句块中，而应直接放在函数体中。Go中大部分函数的代码结构几乎相同，首先是一系列的初始检查，防止错误发生，之后是函数的实际逻辑。

### 函数值

* 在Go中，函数被看作第一类值, 函数像其他值一样，拥有类型，可以被赋值给其他变量，传递给函数，从函数返回
* 函数类型的零值是nil。调用值为nil的函数值会引起panic错误
* 函数值可以与nil比较, 但是函数值之间是不可比较的，也不能用函数值作为map的key
* 函数值使得我们不仅仅可以通过数据来参数化函数，亦可通过行为